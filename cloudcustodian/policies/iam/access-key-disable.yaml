policies:
  - name: access-key-disable-policy
    resource: iam-user
    mode:
        type: periodic
        schedule: "rate(1 day)"
        role: cloud-custodian-admin-access
    filters:
      - type: access-key
        key: Status
        value: Active
      - type: access-key
        key: CreateDate
        value: 85
        op: greater-than
        value_type: age
    actions:
      - type: notify
        slack_template: slack_default
        violation_desc: 'AWS access keys over 85 days old'
        action_desc: 'AWS access keys have been disabled - *ROTATE NOW*'
        to:
          -  {slack_webhook_url}
        transport:
          type: sqs
          queue: {sqs_queue_url}
      - type: remove-keys
        disable: true